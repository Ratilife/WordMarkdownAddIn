# –ú–æ–¥—É–ª—å ThisAddIn

## –û–ø–∏—Å–∞–Ω–∏–µ
–ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∏ Word, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∏ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é —Ä–∞–±–æ—Ç—ã –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –º–æ–¥—É–ª—è–º–∏.

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞–Ω–µ–ª–∏ –∑–∞–¥–∞—á (TaskPane) —Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º Markdown
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–µ–Ω—Ç—ã Ribbon
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è —Å–≤–æ–π—Å—Ç–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π

### ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Word
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ `DocumentBeforeSave` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è Markdown
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ Markdown –∏–∑ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–∞–Ω–µ–ª–∏ (—à–∏—Ä–∏–Ω–∞, –≤–∏–¥–∏–º–æ—Å—Ç—å) –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏

### ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–Ω–µ–ª—å—é
- –ú–µ—Ç–æ–¥ `TogglePane()` –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–∏
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º:
  - `MarkdownPane` - –ø–∞–Ω–µ–ª—å –∑–∞–¥–∞—á
  - `PaneControl` - –∫–æ–Ω—Ç—Ä–æ–ª —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
  - `Ribbon` - –ª–µ–Ω—Ç–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
  - `Instance` - —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∏

### ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
- `ThisAddIn_Startup` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- `ThisAddIn_Shutdown` - –æ—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
- `Application_DocumentBeforeSave` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ Markdown –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞

## –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–ø–∏—Å–∞—Ç—å

### üî® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **–£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å–∫–ª—é—á–µ–Ω–∏–π**: –í–µ–∑–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—É—Å—Ç—ã–µ –±–ª–æ–∫–∏ `catch { }`, —á—Ç–æ —Å–∫—Ä—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
  - –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
  - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
  - –†–∞–∑–ª–∏—á–∞—Ç—å —Ç–∏–ø—ã –æ—à–∏–±–æ–∫ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ/–Ω–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ)

### üî® –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∞–Ω–µ–ª–∏
- **–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫**: –ö–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç `PaneWidth` –∏ `PaneVisible` –≤ —Å–ª–æ–≤–∞—Ä–µ, –Ω–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
  - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ `Properties` –∏–ª–∏ –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Word
  - –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –∏ –≤–∏–¥–∏–º–æ—Å—Ç—å –ø–∞–Ω–µ–ª–∏

### üî® –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**: –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –¥—Ä—É–≥–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω—É–∂–Ω–æ:
  - –ó–∞–≥—Ä—É–∂–∞—Ç—å Markdown –∏–∑ –Ω–æ–≤–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
  - –°–æ—Ö—Ä–∞–Ω—è—Ç—å Markdown –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
  - –ü–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è –Ω–æ–≤–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞

### üî® –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **–°–æ–±—ã—Ç–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è/—Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**: 
  - `Application.DocumentOpen`
  - `Application.NewDocument`
  - `Application.DocumentBeforeClose`

### üî® –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è Word
- **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ Word**:
  - –°–æ—Ö—Ä–∞–Ω—è—Ç—å Markdown –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ Word (—Å–æ–±—ã—Ç–∏–µ `Application.Quit`)
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—Ç–º–µ–Ω—É –∑–∞–∫—Ä—ã—Ç–∏—è

## –û—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å

### ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ TaskPaneControl
- –í `ThisAddIn.cs` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ Markdown –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ `PaneControl` –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ WebView2 –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π Markdown

### ‚ùå –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —É—Ç–µ—á–∫–∞ COM-–æ–±—ä–µ–∫—Ç–æ–≤
- –í –º–µ—Ç–æ–¥–µ `ThisAddIn_Shutdown` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Marshal.ReleaseComObject(Application)`, –Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
- Word Application - —ç—Ç–æ –∫–æ—Ä–Ω–µ–≤–æ–π –æ–±—ä–µ–∫—Ç, –µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ —è–≤–Ω–æ –æ—Å–≤–æ–±–æ–∂–¥–∞—Ç—å
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É 93

### ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null
- –í `Application_DocumentBeforeSave` –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ `PaneControl` –Ω–∞ null
- –í `TogglePane()` –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null –ø–µ—Ä–µ–¥ –æ–±—Ä–∞—â–µ–Ω–∏–µ–º –∫ —Å–≤–æ–π—Å—Ç–≤–∞–º

### ‚ùå –ù–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Ribbon
- Ribbon —Å–æ–∑–¥–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–Ω–æ–ø–æ–∫
- –ù–µ—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É –≤–∏–¥–∏–º–æ—Å—Ç—å—é –ø–∞–Ω–µ–ª–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–Ω–æ–ø–∫–∏ –≤ Ribbon

### ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ Markdown –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª –¥–æ–∫—É–º–µ–Ω—Ç –≤—Ä—É—á–Ω—É—é

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

1. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å System.Diagnostics.Debug –∏–ª–∏ —Ñ–∞–π–ª–æ–≤—ã–π –ª–æ–≥–≥–µ—Ä
2. **–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**: –í—ã–Ω–µ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—à–∏—Ä–∏–Ω–∞ –ø–∞–Ω–µ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª
3. **–£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å try-catch —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
4. **–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é**: –ü—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å COM-–æ–±—ä–µ–∫—Ç–æ–≤ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
5. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω Dispose**: –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤


































