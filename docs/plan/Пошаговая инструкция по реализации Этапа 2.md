## üìö –≠—Ç–∞–ø 2: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è DOCX ‚Üí Markdown ‚Üí HTML

---

## üéØ –ó–∞–¥–∞—á–∞ 2.1: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ Word –¥–æ–∫—É–º–µ–Ω—Ç–µ

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è
–ù—É–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Word –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –∏—Ö –≤ Markdown. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–±—ã—Ç–∏—è Word –∏ –¥–µ–±–∞—É–Ω—Å, —á—Ç–æ–±—ã –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–∞–∂–¥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∫–ª–∞–≤–∏—à–∏.

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ WordToMarkdownService

–ß—Ç–æ –¥–µ–ª–∞—Ç—å:
1. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å `WordToMarkdownService` –≤ –ø–∞–ø–∫–µ `Services`.
2. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞:
   - –•—Ä–∞–Ω–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ `Word.Application`
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–π–º–µ—Ä –¥–ª—è –¥–µ–±–∞—É–Ω—Å–∞
   - –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ Markdown

–ö–æ–Ω—Ü–µ–ø—Ü–∏—è –¥–µ–±–∞—É–Ω—Å–∞:
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å—Ä–∞–∑—É
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–∞–π–º–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, 500 –º—Å)
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–∞—É–∑—ã –≤ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –∏ –¥–µ–ª–∞–µ—Ç —Ä–∞–±–æ—Ç—É –ø–ª–∞–≤–Ω–µ–µ

–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫–ª–∞—Å—Å–µ:
- –ü–æ–ª–µ –¥–ª—è `Word.Application`
- –ü–æ–ª–µ –¥–ª—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ç–µ–∫—Å—Ç–∞ (–¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è)
- –¢–∞–π–º–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, `System.Timers.Timer` –∏–ª–∏ `System.Threading.Timer`)
- –§–ª–∞–≥, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—â–∏–π —Ä–µ–∫—É—Ä—Å–∏—é (–µ—Å–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Word –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ)

### –®–∞–≥ 2: –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è Word –≤ ThisAddIn.cs

–°–æ–±—ã—Ç–∏—è Word:

1. `Application.DocumentBeforeSave` (—É–∂–µ –µ—Å—Ç—å)
   - –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è Markdown

2. `Application.WindowSelectionChange`
   - –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `Selection` (—Ç–µ–∫—É—â–µ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—ã–¥–µ–ª–µ–Ω–∏—è

3. `Document.ContentControlOnEnter`
   - –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ ContentControl
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `ContentControl`
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö

–í–∞–∂–Ω–æ:
- –ü–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤ `ThisAddIn_Startup`
- –û—Ç–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤ `ThisAddIn_Shutdown`
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ (try-catch)

–ì–¥–µ –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è:
- `Application.WindowSelectionChange` ‚Äî –Ω–∞ —É—Ä–æ–≤–Ω–µ `Application`
- `Document.ContentControlOnEnter` ‚Äî –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–∞–∂–¥–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞

### –®–∞–≥ 3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

–ú–µ—Ç–æ–¥—ã –≤ `WordToMarkdownService`:

1. `GetDocumentText()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≤–µ—Å—å —Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Document.Content.Text` –∏–ª–∏ `Document.Range().Text`
   - –í–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å—Ç—Ä–æ–∫—É

2. `GetSelectionText()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç –≤—ã–¥–µ–ª–µ–Ω–∏—è
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Application.Selection.Text`
   - –í–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å—Ç—Ä–æ–∫—É –∏–ª–∏ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É, –µ—Å–ª–∏ –Ω–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏—è

3. `OnDocumentChanged()` ‚Äî –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ç–µ–∫—Å—Ç
   - –°—Ä–∞–≤–Ω–∏—Ç—å —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º
   - –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–±–∞—É–Ω—Å-—Ç–∞–π–º–µ—Ä
   - –ü–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–∞–π–º–µ—Ä–∞ ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ Markdown –∏ –≤—ã–∑–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ

4. `CompareWithPrevious()` ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π
   - –°—Ä–∞–≤–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ç–µ–∫—Å—Ç —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º
   - –í–µ—Ä–Ω—É—Ç—å `true`, –µ—Å–ª–∏ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –®–∞–≥ 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ThisAddIn

–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å:
1. –í `ThisAddIn_Startup` —Å–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä `WordToMarkdownService`
2. –ü–µ—Ä–µ–¥–∞—Ç—å `this.Application` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
3. –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è Markdown (–Ω–∞–ø—Ä–∏–º–µ—Ä, `MarkdownChanged`)
4. –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –≤—ã–∑–≤–∞—Ç—å `PaneControl.SetMarkdown()` —Å –Ω–æ–≤—ã–º —Ç–µ–∫—Å—Ç–æ–º

---

## üéØ –ó–∞–¥–∞—á–∞ 2.2: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Word ‚Üí Markdown

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è
–ù—É–∂–Ω–æ –∏–∑–≤–ª–µ–∫–∞—Ç—å —Ç–µ–∫—Å—Ç –∏–∑ Word –∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å Markdown-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å, –µ—Å–ª–∏ –æ–Ω –Ω–∞–ø–∏—Å–∞–Ω –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç.

### –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ WordToMarkdownConverter

–ß—Ç–æ –¥–µ–ª–∞—Ç—å:
1. –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å `WordToMarkdownConverter` –≤ –ø–∞–ø–∫–µ `Services`
2. –ö–ª–∞—Å—Å –º–æ–∂–µ—Ç –±—ã—Ç—å `static` (–µ—Å–ª–∏ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ) –∏–ª–∏ –æ–±—ã—á–Ω—ã–º

–ú–µ—Ç–æ–¥—ã:

1. `ExtractTextFromWord()`
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `Word.Document` –∏–ª–∏ `Word.Selection`
   - –ò–∑–≤–ª–µ—á—å —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ `Range.Text` –∏–ª–∏ `Selection.Text`
   - –í–µ—Ä–Ω—É—Ç—å —Å—Ç—Ä–æ–∫—É

2. `DetectMarkdownSyntax()`
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: —Ç–µ–∫—Å—Ç –∏–∑ Word
   - –ù–∞–π—Ç–∏ Markdown-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å —á–µ—Ä–µ–∑ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
   - –í–µ—Ä–Ω—É—Ç—å —Ç–µ–∫—Å—Ç —Å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º

3. `ValidateMarkdown()` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
   - –í–µ—Ä–Ω—É—Ç—å `true/false` –∏–ª–∏ —Å–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫

### –®–∞–≥ 6: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π

–ß—Ç–æ –∏—Å–∫–∞—Ç—å:

1. –ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç: `**—Ç–µ–∫—Å—Ç**` –∏–ª–∏ `__—Ç–µ–∫—Å—Ç__`
   - –ü–∞—Ç—Ç–µ—Ä–Ω: `\*\*([^*]+)\*\*` –∏–ª–∏ `__([^_]+)__`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞: —Å–∏–º–≤–æ–ª—ã `**` –∏–ª–∏ `__` –≤–æ–∫—Ä—É–≥ —Ç–µ–∫—Å—Ç–∞

2. –ö—É—Ä—Å–∏–≤: `*—Ç–µ–∫—Å—Ç*` –∏–ª–∏ `_—Ç–µ–∫—Å—Ç_`
   - –ü–∞—Ç—Ç–µ—Ä–Ω: `\*([^*]+)\*` –∏–ª–∏ `_([^_]+)_`
   - –í–∞–∂–Ω–æ: –Ω–µ –ø—É—Ç–∞—Ç—å —Å –∂–∏—Ä–Ω—ã–º (–ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ –Ω–µ—Ç –¥–≤–æ–π–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤)

3. –ó–∞–≥–æ–ª–æ–≤–∫–∏: `# –ó–∞–≥–æ–ª–æ–≤–æ–∫`, `## –ó–∞–≥–æ–ª–æ–≤–æ–∫` –∏ —Ç.–¥.
   - –ü–∞—Ç—Ç–µ—Ä–Ω: `^#{1,6}\s+(.+)$`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞: —Å–∏–º–≤–æ–ª—ã `#` –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏ (1‚Äì6 —à—Ç—É–∫)

4. –°–ø–∏—Å–∫–∏: `- —ç–ª–µ–º–µ–Ω—Ç` –∏–ª–∏ `* —ç–ª–µ–º–µ–Ω—Ç` –∏–ª–∏ `1. —ç–ª–µ–º–µ–Ω—Ç`
   - –ü–∞—Ç—Ç–µ—Ä–Ω: `^[-*]\s+(.+)$` –∏–ª–∏ `^\d+\.\s+(.+)$`

5. –ö–æ–¥: `` `–∫–æ–¥` `` –∏–ª–∏ ` ```–∫–æ–¥``` `
   - –ü–∞—Ç—Ç–µ—Ä–Ω: `` `([^`]+)` `` –∏–ª–∏ `` ```([^`]+)``` ``

–í–∞–∂–Ω–æ:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `RegexOptions.Multiline` –¥–ª—è –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- –£—á–∏—Ç—ã–≤–∞—Ç—å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã —Å–ª–æ–≤, –≥–¥–µ –Ω—É–∂–Ω–æ

### –®–∞–≥ 7: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞ —Å —Å–µ—Ä–≤–∏—Å–æ–º

–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å:
1. –í `WordToMarkdownService` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `WordToMarkdownConverter`
2. –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
   - –í—ã–∑–≤–∞—Ç—å `ExtractTextFromWord()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
   - –í—ã–∑–≤–∞—Ç—å `DetectMarkdownSyntax()` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
   - –í—ã–∑–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ `MarkdownChanged` —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º

---

## üéØ –ó–∞–¥–∞—á–∞ 2.3: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ HTML

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è
–¶–µ–ø–æ—á–∫–∞: Word –∏–∑–º–µ–Ω—è–µ—Ç—Å—è ‚Üí –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è Markdown ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ä–µ–¥–∞–∫—Ç–æ—Ä ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è HTML.

### –®–∞–≥ 8: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞

–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ `TaskPaneControl.cs`:

1. –ú–µ—Ç–æ–¥ `CoreWebView2_WebMessageReceived`
   - –ï—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∞ `mdChanged`
   - –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `_renderer.RenderoHtml()`
   - –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ WebView2 —á–µ—Ä–µ–∑ `PostRenderHtml()`

2. –ú–µ—Ç–æ–¥ `SetMarkdown()`
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Markdown –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
   - –≠—Ç–æ –¥–æ–ª–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ `mdChanged` –∏–∑ JavaScript
   - –¶–µ–ø–æ—á–∫–∞: `SetMarkdown()` ‚Üí JavaScript –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `mdChanged` ‚Üí C# —Ä–µ–Ω–¥–µ—Ä–∏—Ç HTML

### –®–∞–≥ 9: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–µ–±–∞—É–Ω—Å–∞

–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –¥–µ–±–∞—É–Ω—Å:
- –í JavaScript –≤–Ω—É—Ç—Ä–∏ `BuildHtmlShell()` –≤ `TaskPaneControl.cs`
- –§—É–Ω–∫—Ü–∏—è `debounce` –≤ HTML-—Å—Ç—Ä–æ–∫–µ

–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
1. –ù–∞–π—Ç–∏ —Ñ—É–Ω–∫—Ü–∏—é `debounce` –≤ –º–µ—Ç–æ–¥–µ `BuildHtmlShell()`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É (–æ–±—ã—á–Ω–æ 120‚Äì200 –º—Å)
3. –ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫—É —Å `editor.addEventListener('input', debounce(...))`

–ö–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å:
- –ï—Å–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ ‚Äî —É–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É (200‚Äì300 –º—Å)
- –ï—Å–ª–∏ —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ ‚Äî —É–º–µ–Ω—å—à–∏—Ç—å (100‚Äì150 –º—Å)
- –£—á–µ—Å—Ç—å, —á—Ç–æ –¥–µ–±–∞—É–Ω—Å —É–∂–µ –µ—Å—Ç—å –≤ JavaScript, –ø–æ—ç—Ç–æ–º—É –≤ C# –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É

### –®–∞–≥ 10: –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–¶–µ–ø–æ—á–∫–∞ —Ä–∞–±–æ—Ç—ã:

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç Word
2. –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ Word (–Ω–∞–ø—Ä–∏–º–µ—Ä, `WindowSelectionChange`)
3. `WordToMarkdownService` –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ
4. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–µ–±–∞—É–Ω—Å-—Ç–∞–π–º–µ—Ä (500 –º—Å)
5. –ü–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–∞–π–º–µ—Ä–∞:
   - –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ `WordToMarkdownConverter.ExtractTextFromWord()`
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —á–µ—Ä–µ–∑ `WordToMarkdownConverter.DetectMarkdownSyntax()`
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ `MarkdownChanged`
6. –í `ThisAddIn` –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–∑—ã–≤–∞–µ—Ç `PaneControl.SetMarkdown()`
7. `SetMarkdown()` –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä –≤ WebView2
8. JavaScript –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `mdChanged` –≤ C#
9. `TaskPaneControl` –ø–æ–ª—É—á–∞–µ—Ç `mdChanged`, –≤—ã–∑—ã–≤–∞–µ—Ç `_renderer.RenderoHtml()`
10. HTML –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ WebView2 —á–µ—Ä–µ–∑ `PostRenderHtml()`
11. HTML –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ preview

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –ü–æ—Ç–æ–∫–∏ –∏ COM-–æ–±—ä–µ–∫—Ç—ã
- –°–æ–±—ã—Ç–∏—è Word –º–æ–≥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
- –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Invoke` –∏–ª–∏ `BeginInvoke`
- COM-–æ–±—ä–µ–∫—Ç—ã Word —Ç—Ä–µ–±—É—é—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã (–Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ª–∏—à–Ω–∏—Ö —Å—Å—ã–ª–æ–∫)

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –î–µ–±–∞—É–Ω—Å –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω (–∏–Ω–∞—á–µ –±—É–¥–µ—Ç –ª–∞–≥–∞—Ç—å)
- –ù–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–∞–∂–¥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∫–ª–∞–≤–∏—à–∏
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –í—Å–µ–≥–¥–∞ –æ–±–æ—Ä–∞—á–∏–≤–∞–π—Ç–µ —Ä–∞–±–æ—Ç—É —Å Word –≤ try-catch
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –Ω–∞ null –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–±—ä–µ–∫—Ç–æ–≤ Word
- –õ–æ–≥–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–æ–º–ø–∏–ª—è—Ü–∏—é
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ Word –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–±–æ—Ç—É –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –≤–≤–æ–¥–µ —Ç–µ–∫—Å—Ç–∞
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–±–æ—Ç—É –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞

---

## üìù –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. –°–æ–∑–¥–∞—Ç—å `WordToMarkdownService.cs` (–±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è –≤ `ThisAddIn.cs`
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –≤ `WordToMarkdownService`
4. –î–æ–±–∞–≤–∏—Ç—å –¥–µ–±–∞—É–Ω—Å-—Ç–∞–π–º–µ—Ä
5. –°–æ–∑–¥–∞—Ç—å `WordToMarkdownConverter.cs`
6. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è Markdown
7. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä —Å —Å–µ—Ä–≤–∏—Å–æ–º
8. –°–≤—è–∑–∞—Ç—å —Å–µ—Ä–≤–∏—Å —Å `TaskPaneControl`
9. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ–±–∞—É–Ω—Å
10. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é —Ü–µ–ø–æ—á–∫—É

–ì–æ—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –ª—é–±–æ–º—É —à–∞–≥—É.