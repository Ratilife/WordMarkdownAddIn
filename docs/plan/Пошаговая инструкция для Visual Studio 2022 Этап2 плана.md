# –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è Visual Studio 2022
## –≠—Ç–∞–ø 2: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è DOCX ‚Üí Markdown ‚Üí HTML (–°—Ü–µ–Ω–∞—Ä–∏–π 1)

---

## üìã –ó–∞–¥–∞—á–∞ 2.1: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ Word –¥–æ–∫—É–º–µ–Ω—Ç–µ

### –®–∞–≥ 1: –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ Visual Studio 2022

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Visual Studio 2022**
   - –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **–ü—É—Å–∫** –≤ Windows
   - –ù–∞–π–¥–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ **Visual Studio 2022**

2. **–û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ—à–µ–Ω–∏–µ (Solution)**
   - –í Visual Studio –Ω–∞–∂–º–∏—Ç–µ: **File ‚Üí Open ‚Üí Project/Solution** (–∏–ª–∏ `Ctrl+Shift+O`)
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞: `F:\–Ø–∑—ã–∫–∏\C#\Partholio\WordMarkdownAddIn`
   - –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª **WordMarkdownAddIn.sln**
   - –ù–∞–∂–º–∏—Ç–µ **Open**

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞**
   - –í **Solution Explorer** (–æ–∫–Ω–æ —Å–ª–µ–≤–∞) –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
     - `WordMarkdownAddIn` (–ø—Ä–æ–µ–∫—Ç)
     - `ThisAddIn.cs`
     - `Controls/TaskPaneControl.cs`
     - `Services/DocumentSyncService.cs`
     - `Services/MarkdownRenderService.cs`

---

### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å WordToMarkdownService.cs

1. **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å –≤ –ø–∞–ø–∫–µ Services**
   - –í **Solution Explorer** –Ω–∞–π–¥–∏—Ç–µ –ø–∞–ø–∫—É **Services**
   - **–ü—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏** –Ω–∞ –ø–∞–ø–∫–µ **Services**
   - –í—ã–±–µ—Ä–∏—Ç–µ: **Add ‚Üí Class...**
   - –í –¥–∏–∞–ª–æ–≥–æ–≤–æ–º –æ–∫–Ω–µ **Add New Item**:
     - –í –ø–æ–ª–µ **Name** –≤–≤–µ–¥–∏—Ç–µ: `WordToMarkdownService.cs`
     - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–±—Ä–∞–Ω —à–∞–±–ª–æ–Ω **Class**
     - –ù–∞–∂–º–∏—Ç–µ **Add**

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞**
   - –í **Solution Explorer** –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –ø–∞–ø–∫–∞/—Ñ–∞–π–ª: `Services/WordToMarkdownService.cs`
   - –§–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ

---

### –®–∞–≥ 3: –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å ThisAddIn.cs –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è Word

1. **–û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª ThisAddIn.cs**
   - –í **Solution Explorer** –Ω–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª **ThisAddIn.cs**
   - **–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫** –Ω–∞ —Ñ–∞–π–ª–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –µ–≥–æ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ

2. **–ù–∞–π—Ç–∏ –º–µ—Ç–æ–¥ ThisAddIn_Startup**
   - –ù–∞–∂–º–∏—Ç–µ `Ctrl+F` –¥–ª—è –ø–æ–∏—Å–∫–∞
   - –í–≤–µ–¥–∏—Ç–µ: `ThisAddIn_Startup`
   - –ù–∞–∂–º–∏—Ç–µ **Enter**
   - –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –º–µ—Ç–æ–¥ –æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 27

3. **–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —Å–æ–±—ã—Ç–∏–µ WindowSelectionChange**
   - –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É —Å `this.Application.DocumentBeforeSave += Application_DocumentBeforeSave;` (–æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 73)
   - –ü–æ—Å–ª–µ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è
   - **–í–∞–∂–Ω–æ**: –î–æ–±–∞–≤—å—Ç–µ –∫–æ–¥ –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 73, –Ω–æ –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞ `try { }`

4. **–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —Å–æ–±—ã—Ç–∏–µ ContentControlOnEnter**
   - –ù–∞–π–¥–∏—Ç–µ –∞–∫—Ç–∏–≤–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –≤ –º–µ—Ç–æ–¥–µ `ThisAddIn_Startup`
   - –ü–æ—Å–ª–µ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ `WindowSelectionChange` –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —Å–æ–±—ã—Ç–∏–µ `ContentControlOnEnter`
   - **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –≠—Ç–æ —Å–æ–±—ã—Ç–∏–µ –Ω—É–∂–Ω–æ –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞

5. **–ù–∞–π—Ç–∏ –º–µ—Ç–æ–¥ ThisAddIn_Shutdown**
   - –ù–∞–∂–º–∏—Ç–µ `Ctrl+F` –∏ –Ω–∞–π–¥–∏—Ç–µ: `ThisAddIn_Shutdown`
   - –í –º–µ—Ç–æ–¥–µ `ThisAddIn_Shutdown` –¥–æ–±–∞–≤—å—Ç–µ –æ—Ç–ø–∏—Å–∫—É –æ—Ç –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π
   - –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É —Å `this.Application.DocumentBeforeSave -= Application_DocumentBeforeSave;` (–æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 91)
   - –î–æ–±–∞–≤—å—Ç–µ –æ—Ç–ø–∏—Å–∫—É –æ—Ç –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π –ø–æ—Å–ª–µ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–∏

6. **–°–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π**
   - –ü–æ—Å–ª–µ –º–µ—Ç–æ–¥–∞ `Application_DocumentBeforeSave` (–æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 115)
   - –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Å–æ–±—ã—Ç–∏–π:
     - `Application_WindowSelectionChange`
     - `Document_ContentControlOnEnter`

---

### –®–∞–≥ 4: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å WordToMarkdownService.cs

1. **–û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª WordToMarkdownService.cs**
   - –í **Solution Explorer** –Ω–∞–π–¥–∏—Ç–µ `Services/WordToMarkdownService.cs`
   - **–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫** –Ω–∞ —Ñ–∞–π–ª–µ

2. **–î–æ–±–∞–≤–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ using-–¥–∏—Ä–µ–∫—Ç–∏–≤—ã**
   - –í –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞, –ø–æ—Å–ª–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö `using`, –¥–æ–±–∞–≤—å—Ç–µ:
     - `using Microsoft.Office.Interop.Word;`
     - `using System.Threading;`
     - `using System.Threading.Tasks;`
     - `using System.Timers;` (–∏–ª–∏ `using System.Windows.Forms;` –¥–ª—è Timer)

3. **–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å WordToMarkdownService**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–ª–∞—Å—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º–µ–Ω `WordMarkdownAddIn.Services`
   - –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—è –∫–ª–∞—Å—Å–∞ –¥–ª—è:
     - –•—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ `Word.Application`
     - –•—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è)
     - –¢–∞–π–º–µ—Ä–∞ –¥–ª—è –¥–µ–±–∞—É–Ω—Å–∞
     - –§–ª–∞–≥–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Ä–µ–∫—É—Ä—Å–∏–∏

4. **–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä**
   - –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `Word.Application`
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ç–∞–π–º–µ—Ä –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ

5. **–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π**
   - –ú–µ—Ç–æ–¥ `GetDocumentText()` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ –≤—Å–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - –ú–µ—Ç–æ–¥ `GetSelectionText()` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ –≤—ã–¥–µ–ª–µ–Ω–∏—è
   - –ú–µ—Ç–æ–¥ `OnDocumentChanged()` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å –¥–µ–±–∞—É–Ω—Å–æ–º
   - –ú–µ—Ç–æ–¥ `CompareWithPrevious()` - –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

---

## üìã –ó–∞–¥–∞—á–∞ 2.2: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Word ‚Üí Markdown

### –®–∞–≥ 5: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å WordToMarkdownConverter.cs

1. **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å**
   - –í **Solution Explorer** –Ω–∞–π–¥–∏—Ç–µ –ø–∞–ø–∫—É **Services**
   - **–ü—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏** –Ω–∞ –ø–∞–ø–∫–µ **Services**
   - –í—ã–±–µ—Ä–∏—Ç–µ: **Add ‚Üí Class...**
   - –í –¥–∏–∞–ª–æ–≥–æ–≤–æ–º –æ–∫–Ω–µ:
     - –í –ø–æ–ª–µ **Name** –≤–≤–µ–¥–∏—Ç–µ: `WordToMarkdownConverter.cs`
     - –ù–∞–∂–º–∏—Ç–µ **Add**

2. **–û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª WordToMarkdownConverter.cs**
   - –§–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ

3. **–î–æ–±–∞–≤–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ using-–¥–∏—Ä–µ–∫—Ç–∏–≤—ã**
   - –î–æ–±–∞–≤—å—Ç–µ:
     - `using Microsoft.Office.Interop.Word;`
     - `using System.Text.RegularExpressions;`
     - `using System.Text;`

4. **–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å WordToMarkdownConverter**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–ª–∞—Å—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º–µ–Ω `WordMarkdownAddIn.Services`
   - –ö–ª–∞—Å—Å –º–æ–∂–µ—Ç –±—ã—Ç—å `static` –∏–ª–∏ –æ–±—ã—á–Ω—ã–º (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

5. **–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è**
   - –ú–µ—Ç–æ–¥ `ExtractTextFromWord()` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ Word –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - –ú–µ—Ç–æ–¥ `DetectMarkdownSyntax()` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Markdown-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –≤ —Ç–µ–∫—Å—Ç–µ
   - –ú–µ—Ç–æ–¥ `ValidateMarkdown()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ Markdown

6. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è**
   - –î–ª—è –ø–æ–∏—Å–∫–∞ `**—Ç–µ–∫—Å—Ç**` (–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç)
   - –î–ª—è –ø–æ–∏—Å–∫–∞ `*—Ç–µ–∫—Å—Ç*` (–∫—É—Ä—Å–∏–≤)
   - –î–ª—è –ø–æ–∏—Å–∫–∞ `# –ó–∞–≥–æ–ª–æ–≤–æ–∫` (–∑–∞–≥–æ–ª–æ–≤–∫–∏)
   - –î–ª—è –¥—Ä—É–≥–∏—Ö Markdown-—ç–ª–µ–º–µ–Ω—Ç–æ–≤

---

### –®–∞–≥ 6: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å WordToMarkdownService —Å TaskPaneControl

1. **–û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª ThisAddIn.cs**
   - –ù–∞–π–¥–∏—Ç–µ –º–µ—Å—Ç–æ, –≥–¥–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è —ç–∫–∑–µ–º–ø–ª—è—Ä `WordToMarkdownService`
   - –≠—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –º–µ—Ç–æ–¥–µ `ThisAddIn_Startup`

2. **–°–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä WordToMarkdownService**
   - –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è `PaneControl` (–æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 36)
   - –°–æ–∑–¥–∞–π—Ç–µ —ç–∫–∑–µ–º–ø–ª—è—Ä `WordToMarkdownService`
   - –ü–µ—Ä–µ–¥–∞–π—Ç–µ –µ–º—É `this.Application`

3. **–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π**
   - –í `WordToMarkdownService` —Å–æ–∑–¥–∞–π—Ç–µ —Å–æ–±—ã—Ç–∏–µ `MarkdownChanged`
   - –í `ThisAddIn.cs` –ø–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ
   - –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ —Å–æ–±—ã—Ç–∏—è –≤—ã–∑–æ–≤–∏—Ç–µ `PaneControl.SetMarkdown()`

4. **–°–≤—è–∑–∞—Ç—å WordToMarkdownConverter —Å WordToMarkdownService**
   - –í `WordToMarkdownService` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `WordToMarkdownConverter` –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
   - –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤—ã–∑—ã–≤–∞–π—Ç–µ –º–µ—Ç–æ–¥—ã –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞

---

## üìã –ó–∞–¥–∞—á–∞ 2.3: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ HTML

### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è HTML –≤ TaskPaneControl.cs

1. **–û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª TaskPaneControl.cs**
   - –í **Solution Explorer** –Ω–∞–π–¥–∏—Ç–µ `Controls/TaskPaneControl.cs`
   - **–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫** –Ω–∞ —Ñ–∞–π–ª–µ

2. **–ù–∞–π—Ç–∏ –º–µ—Ç–æ–¥ CoreWebView2_WebMessageReceived**
   - –ù–∞–∂–º–∏—Ç–µ `Ctrl+F` –∏ –Ω–∞–π–¥–∏—Ç–µ: `CoreWebView2_WebMessageReceived`
   - –ú–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 70

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–±—ã—Ç–∏—è mdChanged**
   - –ù–∞–π–¥–∏—Ç–µ –±–ª–æ–∫ –∫–æ–¥–∞ —Å `if (type == "mdChanged")` (–æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 85)
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–º –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:
     - `_renderer.RenderoHtml(payload)` - –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è Markdown –≤ HTML
     - `PostRenderHtml(html)` - –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ HTML –≤ WebView2

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ–±–∞—É–Ω—Å –≤ JavaScript**
   - –ù–∞–π–¥–∏—Ç–µ –º–µ—Ç–æ–¥ `BuildHtmlShell()` (–æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 543)
   - –í–Ω—É—Ç—Ä–∏ HTML-—Å—Ç—Ä–æ–∫–∏ –Ω–∞–π–¥–∏—Ç–µ JavaScript-–∫–æ–¥
   - –ù–∞–π–¥–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `debounce` (–æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 908)
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–∞–¥–µ—Ä–∂–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–∫–æ–ª–æ 120ms)

5. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ–±–∞—É–Ω—Å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)**
   - –ï—Å–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ HTML –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ –∏–ª–∏ –º–µ–¥–ª–µ–Ω–Ω–æ
   - –ò–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `debounce`
   - –ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫—É: `editor.addEventListener('input', debounce(notifyChange, 120));`
   - –ò–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ `120` –Ω–∞ –¥—Ä—É–≥–æ–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `200` –¥–ª—è –±–æ–ª–µ–µ –ø–ª–∞–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã)

---

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –ø–æ —Ä–∞–±–æ—Ç–µ —Å Visual Studio 2022

### –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫–æ–¥—É

1. **–ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫**
   - `Ctrl+F` - –ø–æ–∏—Å–∫ –≤ —Ç–µ–∫—É—â–µ–º —Ñ–∞–π–ª–µ
   - `Ctrl+Shift+F` - –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º—É —Ä–µ—à–µ–Ω–∏—é
   - `Ctrl+,` - –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤, –∫–ª–∞—Å—Å–æ–≤, –º–µ—Ç–æ–¥–æ–≤

2. **–ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é**
   - `F12` - –ø–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —Å–∏–º–≤–æ–ª–∞
   - `Ctrl+Click` - –ø–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é (–∫–ª–∏–∫ —Å –∑–∞–∂–∞—Ç—ã–º Ctrl)
   - `Alt+F12` - –ø–æ–∫–∞–∑–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–æ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–º –æ–∫–Ω–µ

3. **–ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞–∑–∞–¥/–≤–ø–µ—Ä–µ–¥**
   - `Ctrl+-` - –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥
   - `Ctrl+Shift+-` - –ø–µ—Ä–µ–π—Ç–∏ –≤–ø–µ—Ä–µ–¥

### –†–∞–±–æ—Ç–∞ —Å IntelliSense

1. **–ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ**
   - –ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∏–º—è –∫–ª–∞—Å—Å–∞/–º–µ—Ç–æ–¥–∞
   - Visual Studio –ø–æ–∫–∞–∂–µ—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Tab` –∏–ª–∏ `Enter` –¥–ª—è –≤—ã–±–æ—Ä–∞

2. **–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è**
   - `Ctrl+.` - –ø–æ–∫–∞–∑–∞—Ç—å –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (Quick Actions)
   - –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è using-–¥–∏—Ä–µ–∫—Ç–∏–≤, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### –û—Ç–ª–∞–¥–∫–∞

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ—á–µ–∫ –æ—Å—Ç–∞–Ω–æ–≤–∞**
   - –ö–ª–∏–∫–Ω–∏—Ç–µ —Å–ª–µ–≤–∞ –æ—Ç –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫–∏ (–ø–æ—è–≤–∏—Ç—Å—è –∫—Ä–∞—Å–Ω–∞—è —Ç–æ—á–∫–∞)
   - –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ `F9` –Ω–∞ –Ω—É–∂–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

2. **–ó–∞–ø—É—Å–∫ —Å –æ—Ç–ª–∞–¥–∫–æ–π**
   - `F5` - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å –æ—Ç–ª–∞–¥–∫–æ–π
   - `Ctrl+F5` - –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–∑ –æ—Ç–ª–∞–¥–∫–∏

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**
   - –ù–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é - —É–≤–∏–¥–∏—Ç–µ –µ—ë –∑–Ω–∞—á–µ–Ω–∏–µ
   - –í –æ–∫–Ω–µ **Watch** –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

### –†–∞–±–æ—Ç–∞ —Å Solution Explorer

1. **–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã**
   - –í **Solution Explorer** –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **Show All Files** (–∏–∫–æ–Ω–∫–∞ —Å —Ñ–∞–π–ª–∞–º–∏)
   - –≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç —Å–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –ø–∞–ø–∫–µ `bin`)

2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ **Solution Explorer**
   - –í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

### –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫

1. **–°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞**
   - `Ctrl+Shift+B` - —Å–æ–±—Ä–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ
   - –ò–ª–∏: **Build ‚Üí Build Solution**

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫**
   - –û–∫–Ω–æ **Error List** (View ‚Üí Error List –∏–ª–∏ `Ctrl+\`, `E`)
   - –û—à–∏–±–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–º, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è - –∂–µ–ª—Ç—ã–º

3. **–û—á–∏—Å—Ç–∫–∞ —Ä–µ—à–µ–Ω–∏—è**
   - **Build ‚Üí Clean Solution** - —É–¥–∞–ª–∏—Ç—å —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
   - **Build ‚Üí Rebuild Solution** - –æ—á–∏—Å—Ç–∏—Ç—å –∏ —Å–æ–±—Ä–∞—Ç—å –∑–∞–Ω–æ–≤–æ

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤**
   - –í—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Ñ–∞–π–ª—ã –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π: `Ctrl+S`
   - –ò–ª–∏ –≤–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: **Tools ‚Üí Options ‚Üí Environment ‚Üí AutoRecover**

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏**
   - –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–∏–º–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
   - –ò—Å–ø—Ä–∞–≤–ª—è–π—Ç–µ –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Å—Ä–∞–∑—É

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç (`F5`)
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–±–æ—Ç—É —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –≤ Word

4. **–†–∞–±–æ—Ç–∞ —Å —Å–æ–±—ã—Ç–∏—è–º–∏ Word**
   - –ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ —Å–æ–±—ã—Ç–∏—è Word –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Invoke` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –∏–∑ –¥—Ä—É–≥–∏—Ö –ø–æ—Ç–æ–∫–æ–≤

5. **–î–µ–±–∞—É–Ω—Å –∏ —Ç–∞–π–º–µ—Ä—ã**
   - –ù–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–æ–≤
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω —Ç–∞–π–º–µ—Ä –¥–ª—è –¥–µ–±–∞—É–Ω—Å–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–∞

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á

### –ó–∞–¥–∞—á–∞ 2.1: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `Services/WordToMarkdownService.cs`
- [ ] –í `ThisAddIn.cs` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ `WindowSelectionChange`
- [ ] –í `ThisAddIn.cs` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ `ContentControlOnEnter`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ç–∞–π–º–µ—Ä/–¥–µ–±–∞—É–Ω—Å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

### –ó–∞–¥–∞—á–∞ 2.2: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Word ‚Üí Markdown
- [ ] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `Services/WordToMarkdownConverter.cs`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ Word
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ Markdown-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è Markdown
- [ ] `WordToMarkdownService` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `WordToMarkdownConverter`
- [ ] –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ Word –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è `TaskPaneControl.SetMarkdown()`

### –ó–∞–¥–∞—á–∞ 2.3: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ HTML
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ –º–µ—Ö–∞–Ω–∏–∑–º–∞ `mdChanged` ‚Üí —Ä–µ–Ω–¥–µ—Ä HTML
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–µ–±–∞—É–Ω—Å –¥–ª—è –ø–ª–∞–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- [ ] HTML –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ Markdown

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≠—Ç–∞–ø–∞ 2

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≠—Ç–∞–ø–∞ 2 –≤—ã —Å–º–æ–∂–µ—Ç–µ:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Word –¥–æ–∫—É–º–µ–Ω—Ç–µ
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –∏–∑ Word –≤ Markdown
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å HTML-–ø—Ä–µ–≤—å—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ Word –¥–æ–∫—É–º–µ–Ω—Ç–∞

**–£–¥–∞—á–∏ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏!** üöÄ

























