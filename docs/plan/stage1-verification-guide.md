# üìã –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≠—Ç–∞–ø–∞ ‚Ññ1

## –¶–µ–ª—å —ç—Ç–∞–ø–∞
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–∞–Ω–µ–ª–∏ (Split, Markdown-only, HTML-only) —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (30 —Å–µ–∫—É–Ω–¥)

**–•–æ—Ç–∏—Ç–µ –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ä–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç?**

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç (F5)
2. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å Markdown –≤ Word
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"Markdown"** ‚Üí –¥–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ª–µ–≤–∞—è –ø–∞–Ω–µ–ª—å (—Ä–µ–¥–∞–∫—Ç–æ—Ä)
4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"HTML"** ‚Üí –¥–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å (–ø—Ä–µ–≤—å—é)
5. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"Split"** ‚Üí –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –æ–±–µ –ø–∞–Ω–µ–ª–∏ —Ä—è–¥–æ–º

**–ï—Å–ª–∏ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç - —ç—Ç–∞–ø ‚Ññ1 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω! ‚úÖ**

–î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–∏—Ç–∞–π—Ç–µ –¥–∞–ª—å—à–µ ‚Üì

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ó–∞–¥–∞—á–∞ 1.1: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ Markdown/HTML –≤ –ø–∞–Ω–µ–ª–∏

#### 1.1.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–Ω–æ–ø–æ–∫ –≤ HTML –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:** `Controls/TaskPaneControl.cs`, –º–µ—Ç–æ–¥ `BuildHtmlShell()`

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- [ ] –í HTML –µ—Å—Ç—å –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–∞–º–∏ (—Å—Ç—Ä–æ–∫–∏ 564-568)
- [ ] –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ "Split" —Å id="btn-split"
- [ ] –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ "Markdown" —Å id="btn-markdown"  
- [ ] –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ "HTML" —Å id="btn-html"
- [ ] –ö–Ω–æ–ø–∫–∏ –∏–º–µ—é—Ç –∫–ª–∞—Å—Å `view-btn`
- [ ] –ö–Ω–æ–ø–∫–∞ "Split" –∏–º–µ–µ—Ç –∫–ª–∞—Å—Å `active` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–æ–¥–µ:**
```html
<!-- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ BuildHtmlShell() -->
<div class="view-controls">
    <button id="btn-split" class="view-btn active">Split</button>
    <button id="btn-markdown" class="view-btn">Markdown</button>
    <button id="btn-html" class="view-btn">HTML</button>
</div>
```

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç (F5)
2. –û—Ç–∫—Ä–æ–π—Ç–µ Word —Å –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–æ–π
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ø–∞–Ω–µ–ª–∏ Markdown –≤–∏–¥–Ω—ã 3 –∫–Ω–æ–ø–∫–∏ –≤–≤–µ—Ä—Ö—É
4. –ö–Ω–æ–ø–∫–∞ "Split" –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∞ (—Å–∏–Ω—è—è)

---

#### 1.1.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ JavaScript —Ñ—É–Ω–∫—Ü–∏–π –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:** `Controls/TaskPaneControl.cs`, –º–µ—Ç–æ–¥ `BuildHtmlShell()`, —Å–µ–∫—Ü–∏—è `<script>`

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**

**a) –§—É–Ω–∫—Ü–∏—è `setViewMode(mode)`:**
- [ ] –§—É–Ω–∫—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∏ 593-621)
- [ ] –û–±–Ω–æ–≤–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `currentViewMode`
- [ ] –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –∫–ª–∞—Å—Å—ã —Ä–µ–∂–∏–º–æ–≤ —Å `body`
- [ ] –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å `view-mode-{mode}` –∫ `body`
- [ ] –û–±–Ω–æ–≤–ª—è–µ—Ç –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É (–¥–æ–±–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å `active`)
- [ ] –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∂–∏–º –≤ `localStorage`
- [ ] –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ C# —á–µ—Ä–µ–∑ `postToHost('viewModeChanged', mode)`

**b) –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫:**
- [ ] –ö–Ω–æ–ø–∫–∞ "Split" –≤—ã–∑—ã–≤–∞–µ—Ç `setViewMode('split')` (—Å—Ç—Ä–æ–∫–∏ 624-626)
- [ ] –ö–Ω–æ–ø–∫–∞ "Markdown" –≤—ã–∑—ã–≤–∞–µ—Ç `setViewMode('markdown')` (—Å—Ç—Ä–æ–∫–∏ 628-630)
- [ ] –ö–Ω–æ–ø–∫–∞ "HTML" –≤—ã–∑—ã–≤–∞–µ—Ç `setViewMode('html')` (—Å—Ç—Ä–æ–∫–∏ 632-634)

**c) –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã–∑–æ–≤–∞ –∏–∑ C#:**
- [ ] `window.setViewMode(mode)` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∏ 637-641)
- [ ] `window.getViewMode()` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∏ 643-645)
- [ ] –û–±–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools –≤ WebView2 (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω—ã)
2. –í –∫–æ–Ω—Å–æ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: `window.getViewMode()` - –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ: `window.setViewMode('markdown')` - –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è —Ä–µ–∂–∏–º
4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ - —Ä–µ–∂–∏–º—ã –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è

---

#### 1.1.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–æ–¥–æ–≤ –≤ TaskPaneControl

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:** `Controls/TaskPaneControl.cs`

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**

**a) –ú–µ—Ç–æ–¥ `SetViewMode(string mode)`:**
- [ ] –ú–µ—Ç–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∏ 400-410)
- [ ] –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å WebView2 (`_coreReady`)
- [ ] –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º (split, markdown, html)
- [ ] –í—ã–∑—ã–≤–∞–µ—Ç JavaScript: `window.setViewMode('{mode}')`

**b) –ú–µ—Ç–æ–¥ `GetCurrentViewModeAsync()`:**
- [ ] –ú–µ—Ç–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∏ 416-435)
- [ ] –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Task<string>`
- [ ] –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å WebView2
- [ ] –í—ã–∑—ã–≤–∞–µ—Ç JavaScript: `window.getViewMode()`
- [ ] –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- [ ] –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç "split" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
1. –í –∫–æ–¥–µ C# –≤—ã–∑–æ–≤–∏—Ç–µ: `PaneControl.SetViewMode("html")`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–∞–Ω–µ–ª—å –ø–µ—Ä–µ–∫–ª—é—á–∏–ª–∞—Å—å
3. –í—ã–∑–æ–≤–∏—Ç–µ: `var mode = await PaneControl.GetCurrentViewModeAsync()`
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–µ—Ä–Ω—É–ª—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–∂–∏–º

---

#### 1.1.4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:**
- `Controls/TaskPaneControl.cs` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ `viewModeChanged` (—Å—Ç—Ä–æ–∫–∏ 93-102)
- `Properties/Settings.settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ViewMode
- `ThisAddIn.cs` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (—Å—Ç—Ä–æ–∫–∏ 52-66)

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**

**a) –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Settings:**
- [ ] –í `Settings.settings` –µ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `ViewMode` (—Å—Ç—Ä–æ–∫–∞ 5)
- [ ] –¢–∏–ø: `System.String`
- [ ] Scope: `User`
- [ ] –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `split`

**b) –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞:**
- [ ] –í `CoreWebView2_WebMessageReceived` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–∏–ø `viewModeChanged` (—Å—Ç—Ä–æ–∫–∏ 93-102)
- [ ] –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `Settings.Default.ViewMode`
- [ ] –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `Settings.Default.Save()`

**c) –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:**
- [ ] –í `ThisAddIn_Startup` –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º (—Å—Ç—Ä–æ–∫–∏ 52-66)
- [ ] –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ä–µ–∂–∏–º–∞
- [ ] –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `PaneControl.SetViewMode(savedMode)` —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º –Ω–∞ "HTML"
2. –ó–∞–∫—Ä–æ–π—Ç–µ Word
3. –û—Ç–∫—Ä–æ–π—Ç–µ Word —Å–Ω–æ–≤–∞
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–µ–∂–∏–º "HTML" –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

### –ó–∞–¥–∞—á–∞ 1.2: –£–ª—É—á—à–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤

#### 1.2.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ CSS —Å—Ç–∏–ª–µ–π –¥–ª—è —Ä–µ–∂–∏–º–æ–≤

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:** `Controls/TaskPaneControl.cs`, –º–µ—Ç–æ–¥ `BuildHtmlShell()`, —Å–µ–∫—Ü–∏—è `<style>`

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**

**a) –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏:**
- [ ] –ï—Å—Ç—å —Å—Ç–∏–ª–∏ –¥–ª—è `.view-controls` (–ø–∞–Ω–µ–ª—å –∫–Ω–æ–ø–æ–∫) (—Å—Ç—Ä–æ–∫–∏ 454-460)
- [ ] –ï—Å—Ç—å —Å—Ç–∏–ª–∏ –¥–ª—è `.view-btn` (–∫–Ω–æ–ø–∫–∏) (—Å—Ç—Ä–æ–∫–∏ 462-480)
- [ ] –ï—Å—Ç—å —Å—Ç–∏–ª–∏ –¥–ª—è `.container` (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞) (—Å—Ç—Ä–æ–∫–∏ 482-485)
- [ ] –ï—Å—Ç—å —Å—Ç–∏–ª–∏ –¥–ª—è `#editor` –∏ `#preview` (—Å—Ç—Ä–æ–∫–∏ 487-508)

**b) –†–µ–∂–∏–º Split (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):**
- [ ] –ö–ª–∞—Å—Å `.view-mode-split` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∏ 511-523)
- [ ] `.container` –∏–º–µ–µ—Ç `display: flex`
- [ ] `#editor` –∏–º–µ–µ—Ç `width: 50%` –∏ `display: block`
- [ ] `#preview` –∏–º–µ–µ—Ç `width: 50%` –∏ `display: block`

**c) –†–µ–∂–∏–º Markdown-only:**
- [ ] –ö–ª–∞—Å—Å `.view-mode-markdown` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∏ 526-537)
- [ ] `#editor` –∏–º–µ–µ—Ç `width: 100%` –∏ `display: block`
- [ ] `#preview` –∏–º–µ–µ—Ç `display: none`

**d) –†–µ–∂–∏–º HTML-only:**
- [ ] –ö–ª–∞—Å—Å `.view-mode-html` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∏ 540-551)
- [ ] `#editor` –∏–º–µ–µ—Ç `display: none`
- [ ] `#preview` –∏–º–µ–µ—Ç `width: 100%` –∏ `display: block`

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ –Ω–∞ —Ä–µ–∂–∏–º "Split" - –æ–±–∞ –ø–∞–Ω–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∏–¥–Ω—ã –ø–æ 50%
2. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ –Ω–∞ "Markdown" - —Ç–æ–ª—å–∫–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä –Ω–∞ 100%
3. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ –Ω–∞ "HTML" - —Ç–æ–ª—å–∫–æ –ø—Ä–µ–≤—å—é –Ω–∞ 100%

---

#### 1.2.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:** `Controls/TaskPaneControl.cs`, CSS —Å—Ç–∏–ª–∏

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- [ ] –£ `#editor` –µ—Å—Ç—å `transition: width 0.3s ease, opacity 0.2s ease` (—Å—Ç—Ä–æ–∫–∞ 498)
- [ ] –£ `#preview` –µ—Å—Ç—å `transition: width 0.3s ease, opacity 0.2s ease` (—Å—Ç—Ä–æ–∫–∞ 507)
- [ ] –£ `.view-btn` –µ—Å—Ç—å `transition: all 0.2s ease` (—Å—Ç—Ä–æ–∫–∞ 469)

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
1. –ü–µ—Ä–µ–∫–ª—é—á–∞–π—Ç–µ —Ä–µ–∂–∏–º—ã
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥—ã –ø–ª–∞–≤–Ω—ã–µ (–Ω–µ —Ä–µ–∑–∫–∏–µ)
3. –ö–Ω–æ–ø–∫–∏ –¥–æ–ª–∂–Ω—ã –ø–ª–∞–≤–Ω–æ –º–µ–Ω—è—Ç—å —Ü–≤–µ—Ç –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

---

## üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ HTML —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–û—Ç–∫—Ä–æ–π—Ç–µ `Controls/TaskPaneControl.cs` –∏ –Ω–∞–π–¥–∏—Ç–µ –º–µ—Ç–æ–¥ `BuildHtmlShell()`:

```csharp
// –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
<div class="view-controls">
    <button id="btn-split" class="view-btn active">Split</button>
    <button id="btn-markdown" class="view-btn">Markdown</button>
    <button id="btn-html" class="view-btn">HTML</button>
</div>
```

‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –°—Ç—Ä–æ–∫–∏ 564-568

---

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ JavaScript –ª–æ–≥–∏–∫–∏

–í —Ç–æ–º –∂–µ –º–µ—Ç–æ–¥–µ –Ω–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é `<script>`:

```javascript
// –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏—è:
function setViewMode(mode) {
    currentViewMode = mode;
    document.body.classList.remove('view-mode-split', 'view-mode-markdown', 'view-mode-html');
    document.body.classList.add('view-mode-' + mode);
    // ... –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
    localStorage.setItem('viewMode', mode);
    postToHost('viewModeChanged', mode);
}
```

‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –°—Ç—Ä–æ–∫–∏ 593-621

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ C# –º–µ—Ç–æ–¥–æ–≤

–í –∫–ª–∞—Å—Å–µ `TaskPaneControl` –Ω–∞–π–¥–∏—Ç–µ:

```csharp
public void SetViewMode(string mode)
{
    if (!_coreReady || _webView?.CoreWebView2 == null) return;
    if (mode != "split" && mode != "markdown" && mode != "html")
        mode = "split";
    _webView.CoreWebView2.ExecuteScriptAsync($"window.setViewMode('{mode}');void(0);");
}

public async Task<string> GetCurrentViewModeAsync()
{
    // ... —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
}
```

‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –°—Ç—Ä–æ–∫–∏ 400-435

---

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫

**–í TaskPaneControl.cs:**
```csharp
if (type == "viewModeChanged")
{
    Settings.Default.ViewMode = payload;
    Settings.Default.Save();
}
```

‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –°—Ç—Ä–æ–∫–∏ 93-102

**–í ThisAddIn.cs:**
```csharp
var savedMode = Settings.Default.ViewMode;
if (!string.IsNullOrEmpty(savedMode) && (savedMode == "split" || savedMode == "markdown" || savedMode == "html"))
{
    Task.Delay(500).ContinueWith(t => {
        PaneControl.SetViewMode(savedMode);
    });
}
```

‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –°—Ç—Ä–æ–∫–∏ 52-66

**–í Settings.settings:**
```xml
<Setting Name="ViewMode" Type="System.String" Scope="User">
    <Value Profile="(Default)">split</Value>
</Setting>
```

‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –°—Ç—Ä–æ–∫–∞ 5

---

## üëÅÔ∏è –ö–∞–∫ –ø–æ–Ω—è—Ç—å, —á—Ç–æ —Ä–µ–∂–∏–º—ã –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è?

### –í–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

#### 1. –†–µ–∂–∏–º "Split" (–†–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω)
**–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:**
- ‚úÖ **–î–≤–µ –ø–∞–Ω–µ–ª–∏ —Ä—è–¥–æ–º** - —Å–ª–µ–≤–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä, —Å–ø—Ä–∞–≤–∞ –ø—Ä–µ–≤—å—é
- ‚úÖ **–ö–∞–∂–¥–∞—è –ø–∞–Ω–µ–ª—å –∑–∞–Ω–∏–º–∞–µ—Ç 50% —à–∏—Ä–∏–Ω—ã**
- ‚úÖ **–ö–Ω–æ–ø–∫–∞ "Split" —Å–∏–Ω—è—è** (–∞–∫—Ç–∏–≤–Ω–∞—è)
- ‚úÖ **–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è** –º–µ–∂–¥—É –ø–∞–Ω–µ–ª—è–º–∏

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Split"
2. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —Å–ª–µ–≤–∞
3. –°–ø—Ä–∞–≤–∞ –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç

---

#### 2. –†–µ–∂–∏–º "Markdown" (–¢–æ–ª—å–∫–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä)
**–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:**
- ‚úÖ **–¢–æ–ª—å–∫–æ –ª–µ–≤–∞—è –ø–∞–Ω–µ–ª—å** (—Ä–µ–¥–∞–∫—Ç–æ—Ä) –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É
- ‚úÖ **–ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å (–ø—Ä–µ–≤—å—é) –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã—Ç–∞**
- ‚úÖ **–ö–Ω–æ–ø–∫–∞ "Markdown" —Å–∏–Ω—è—è** (–∞–∫—Ç–∏–≤–Ω–∞—è)
- ‚úÖ **–†–µ–¥–∞–∫—Ç–æ—Ä –∑–∞–Ω–∏–º–∞–µ—Ç 100% —à–∏—Ä–∏–Ω—ã**

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Markdown"
2. –ü—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏ (–ø—Ä–µ–≤—å—é) –±—ã—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ
3. –†–µ–¥–∞–∫—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω —Ä–∞—Å—Ç—è–Ω—É—Ç—å—Å—è –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É

---

#### 3. –†–µ–∂–∏–º "HTML" (–¢–æ–ª—å–∫–æ –ø—Ä–µ–≤—å—é)
**–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:**
- ‚úÖ **–¢–æ–ª—å–∫–æ –ø—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å** (–ø—Ä–µ–≤—å—é) –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É
- ‚úÖ **–õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å (—Ä–µ–¥–∞–∫—Ç–æ—Ä) –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã—Ç–∞**
- ‚úÖ **–ö–Ω–æ–ø–∫–∞ "HTML" —Å–∏–Ω—è—è** (–∞–∫—Ç–∏–≤–Ω–∞—è)
- ‚úÖ **–ü—Ä–µ–≤—å—é –∑–∞–Ω–∏–º–∞–µ—Ç 100% —à–∏—Ä–∏–Ω—ã**

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "HTML"
2. –õ–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ (—Ä–µ–¥–∞–∫—Ç–æ—Ä) –±—ã—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ
3. –ü—Ä–µ–≤—å—é –¥–æ–ª–∂–Ω–æ —Ä–∞—Å—Ç—è–Ω—É—Ç—å—Å—è –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ DevTools (–¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö)

–ï—Å–ª–∏ —É –≤–∞—Å –≤–∫–ª—é—á–µ–Ω—ã DevTools –≤ WebView2:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞** (F12 –≤ WebView2, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª–∞—Å—Å—ã –Ω–∞ body:**
   ```javascript
   // –í –∫–æ–Ω—Å–æ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
   document.body.className
   // –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: "view-mode-split" –∏–ª–∏ "view-mode-markdown" –∏–ª–∏ "view-mode-html"
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º:**
   ```javascript
   window.getViewMode()
   // –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: "split", "markdown" –∏–ª–∏ "html"
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ localStorage:**
   ```javascript
   localStorage.getItem('viewMode')
   // –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º
   ```

5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∏–¥–∏–º–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤:**
   ```javascript
   // –†–µ–¥–∞–∫—Ç–æ—Ä
   document.getElementById('editor').style.display
   // –í —Ä–µ–∂–∏–º–µ Split/Markdown: "block"
   // –í —Ä–µ–∂–∏–º–µ HTML: "none"
   
   // –ü—Ä–µ–≤—å—é
   document.getElementById('preview').style.display
   // –í —Ä–µ–∂–∏–º–µ Split/HTML: "block"
   // –í —Ä–µ–∂–∏–º–µ Markdown: "none"
   ```

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ C# –∫–æ–¥

–°–æ–∑–¥–∞–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```csharp
// –î–æ–±–∞–≤—å—Ç–µ –≤ ThisAddIn.cs –≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
private async void TestViewModes()
{
    // –¢–µ—Å—Ç 1: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ Markdown
    PaneControl.SetViewMode("markdown");
    await Task.Delay(500); // –ñ–¥–µ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
    var mode1 = await PaneControl.GetCurrentViewModeAsync();
    MessageBox.Show($"–†–µ–∂–∏–º –ø–æ—Å–ª–µ SetViewMode('markdown'): {mode1}");
    // –û–∂–∏–¥–∞–µ–º: "markdown"
    
    // –¢–µ—Å—Ç 2: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ HTML
    PaneControl.SetViewMode("html");
    await Task.Delay(500);
    var mode2 = await PaneControl.GetCurrentViewModeAsync();
    MessageBox.Show($"–†–µ–∂–∏–º –ø–æ—Å–ª–µ SetViewMode('html'): {mode2}");
    // –û–∂–∏–¥–∞–µ–º: "html"
    
    // –¢–µ—Å—Ç 3: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ Split
    PaneControl.SetViewMode("split");
    await Task.Delay(500);
    var mode3 = await PaneControl.GetCurrentViewModeAsync();
    MessageBox.Show($"–†–µ–∂–∏–º –ø–æ—Å–ª–µ SetViewMode('split'): {mode3}");
    // –û–∂–∏–¥–∞–µ–º: "split"
}
```

–í—ã–∑–æ–≤–∏—Ç–µ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏–∑ –∫–Ω–æ–ø–∫–∏ –∏–ª–∏ –≤ `ThisAddIn_Startup` –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏.

---

### –ü–æ—à–∞–≥–æ–≤–∞—è –≤–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç (F5)
2. –û—Ç–∫—Ä–æ–π—Ç–µ Word
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞–Ω–µ–ª—å Markdown –≤–∏–¥–Ω–∞ (—Å–ø—Ä–∞–≤–∞)

#### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ Split
1. **–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Split"**
2. **–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏:**
   - –ö–Ω–æ–ø–∫–∞ "Split" —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **—Å–∏–Ω–µ–π**
   - –î—Ä—É–≥–∏–µ –∫–Ω–æ–ø–∫–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è **–±–µ–ª—ã–º–∏**
   - –í–∏–¥–Ω—ã **–û–ë–ï –ø–∞–Ω–µ–ª–∏** (—Ä–µ–¥–∞–∫—Ç–æ—Ä —Å–ª–µ–≤–∞, –ø—Ä–µ–≤—å—é —Å–ø—Ä–∞–≤–∞)
   - –ö–∞–∂–¥–∞—è –ø–∞–Ω–µ–ª—å –∑–∞–Ω–∏–º–∞–µ—Ç **–ø—Ä–∏–º–µ—Ä–Ω–æ –ø–æ–ª–æ–≤–∏–Ω—É —à–∏—Ä–∏–Ω—ã**

3. **–í–∏–∑—É–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç:**
   - –í–≤–µ–¥–∏—Ç–µ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ: `# –ó–∞–≥–æ–ª–æ–≤–æ–∫`
   - –°–ø—Ä–∞–≤–∞ –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –±–æ–ª—å—à–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫

#### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ Markdown
1. **–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Markdown"**
2. **–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏:**
   - –ö–Ω–æ–ø–∫–∞ "Markdown" —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **—Å–∏–Ω–µ–π**
   - –ö–Ω–æ–ø–∫–∞ "Split" —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **–±–µ–ª–æ–π**
   - **–ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å (–ø—Ä–µ–≤—å—é) –∏—Å—á–µ–∑–∞–µ—Ç**
   - –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å (—Ä–µ–¥–∞–∫—Ç–æ—Ä) **—Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É**

3. **–í–∏–∑—É–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç:**
   - –í—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å **—Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä**
   - –ü—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏ –±—ã—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ

#### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ HTML
1. **–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "HTML"**
2. **–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏:**
   - –ö–Ω–æ–ø–∫–∞ "HTML" —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **—Å–∏–Ω–µ–π**
   - –ö–Ω–æ–ø–∫–∞ "Markdown" —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **–±–µ–ª–æ–π**
   - **–õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å (—Ä–µ–¥–∞–∫—Ç–æ—Ä) –∏—Å—á–µ–∑–∞–µ—Ç**
   - –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å (–ø—Ä–µ–≤—å—é) **—Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É**

3. **–í–∏–∑—É–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç:**
   - –í—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å **—Ç–æ–ª—å–∫–æ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç** (–ø—Ä–µ–≤—å—é)
   - –õ–µ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –±—ã—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ

#### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ –Ω–∞ —Ä–µ–∂–∏–º "HTML"
2. **–ó–∞–∫—Ä–æ–π—Ç–µ Word –ø–æ–ª–Ω–æ—Å—Ç—å—é**
3. **–û—Ç–∫—Ä–æ–π—Ç–µ Word —Å–Ω–æ–≤–∞**
4. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å Markdown**
5. **–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏:**
   - –†–µ–∂–∏–º –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ "HTML"
   - –ö–Ω–æ–ø–∫–∞ "HTML" –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–∏–Ω–µ–π
   - –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–∞–Ω–µ–ª—å –ø—Ä–µ–≤—å—é

---

### –¢–∞–±–ª–∏—Ü–∞ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

| –†–µ–∂–∏–º | –ö–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞ | –†–µ–¥–∞–∫—Ç–æ—Ä –≤–∏–¥–µ–Ω | –ü—Ä–µ–≤—å—é –≤–∏–¥–Ω–æ | –®–∏—Ä–∏–Ω–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ | –®–∏—Ä–∏–Ω–∞ –ø—Ä–µ–≤—å—é |
|-------|----------------|----------------|--------------|------------------|---------------|
| **Split** | Split (—Å–∏–Ω—è—è) | ‚úÖ –î–∞ | ‚úÖ –î–∞ | 50% | 50% |
| **Markdown** | Markdown (—Å–∏–Ω—è—è) | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | 100% | 0% (—Å–∫—Ä—ã—Ç–æ) |
| **HTML** | HTML (—Å–∏–Ω—è—è) | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ | 0% (—Å–∫—Ä—ã—Ç–æ) | 100% |

---

### –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —Ä–µ–∂–∏–º—ã –ù–ï –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è?

#### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ö–Ω–æ–ø–∫–∏ –Ω–µ —Ä–µ–∞–≥–∏—Ä—É—é—Ç
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω—ã)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏ JavaScript
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ WebView2 –∑–∞–≥—Ä—É–∑–∏–ª—Å—è (`_coreReady = true`)

#### –ü—Ä–æ–±–ª–µ–º–∞ 2: –†–µ–∂–∏–º –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è, –Ω–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- CSS –∫–ª–∞—Å—Å—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è? (`document.body.className`)
- –≠–ª–µ–º–µ–Ω—Ç—ã —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è? (`document.getElementById('editor').style.display`)
- CSS —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω?

#### –ü—Ä–æ–±–ª–µ–º–∞ 3: –†–µ–∂–∏–º –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- `localStorage` —Ä–∞–±–æ—Ç–∞–µ—Ç? (`localStorage.getItem('viewMode')`)
- `Settings.Default.ViewMode` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è?
- `Settings.Default.Save()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è?

---

## üß™ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç 1: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
2. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å Markdown
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Markdown"
   - ‚úÖ –î–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä
   - ‚úÖ –ö–Ω–æ–ø–∫–∞ "Markdown" –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–∏–Ω–µ–π
4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "HTML"
   - ‚úÖ –î–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–µ–≤—å—é
   - ‚úÖ –ö–Ω–æ–ø–∫–∞ "HTML" –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–∏–Ω–µ–π
5. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Split"
   - ‚úÖ –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∏–¥–Ω—ã –æ–±–∞ –ø–∞–Ω–µ–ª–∏ (50/50)
   - ‚úÖ –ö–Ω–æ–ø–∫–∞ "Split" –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–∏–Ω–µ–π

---

### –¢–µ—Å—Ç 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞

1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º –Ω–∞ "HTML"
2. –ó–∞–∫—Ä–æ–π—Ç–µ Word –ø–æ–ª–Ω–æ—Å—Ç—å—é
3. –û—Ç–∫—Ä–æ–π—Ç–µ Word —Å–Ω–æ–≤–∞
4. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å Markdown
   - ‚úÖ –†–µ–∂–∏–º –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ "HTML"

---

### –¢–µ—Å—Ç 3: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ C# –∫–æ–¥

–î–æ–±–∞–≤—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥ –≤ `ThisAddIn.cs` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```csharp
// –í –º–µ—Ç–æ–¥–µ ThisAddIn_Startup –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞–Ω–µ–ª–∏:
Task.Delay(2000).ContinueWith(t => {
    PaneControl.SetViewMode("markdown");
    Task.Delay(1000).ContinueWith(t2 => {
        var mode = PaneControl.GetCurrentViewModeAsync().Result;
        MessageBox.Show($"–¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º: {mode}");
    });
});
```

‚úÖ –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: "–¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º: markdown"

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ |
|-----------|--------|----------------|
| –ö–Ω–æ–ø–∫–∏ –≤ HTML | ‚úÖ | TaskPaneControl.cs:564-568 |
| JavaScript setViewMode | ‚úÖ | TaskPaneControl.cs:593-621 |
| –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ | ‚úÖ | TaskPaneControl.cs:624-634 |
| window.setViewMode | ‚úÖ | TaskPaneControl.cs:637-641 |
| window.getViewMode | ‚úÖ | TaskPaneControl.cs:643-645 |
| SetViewMode (C#) | ‚úÖ | TaskPaneControl.cs:400-410 |
| GetCurrentViewModeAsync | ‚úÖ | TaskPaneControl.cs:416-435 |
| –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Settings | ‚úÖ | TaskPaneControl.cs:93-102 |
| –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ | ‚úÖ | ThisAddIn.cs:52-66 |
| CSS –¥–ª—è —Ä–µ–∂–∏–º–æ–≤ | ‚úÖ | TaskPaneControl.cs:510-551 |
| –ê–Ω–∏–º–∞—Ü–∏—è | ‚úÖ | TaskPaneControl.cs:498, 507, 469 |

---

## ‚úÖ –í—ã–≤–æ–¥

**–≠—Ç–∞–ø ‚Ññ1 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω!** 

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ –º–µ—Å—Ç–µ:
- ‚úÖ –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤
- ‚úÖ JavaScript —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ C# –º–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- ‚úÖ CSS —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤
- ‚úÖ –ü–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏

---

## üéì –ß—Ç–æ –≤—ã —É–∑–Ω–∞–ª–∏

1. **–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å HTML —Å—Ç—Ä—É–∫—Ç—É—Ä—É:** –ò—â–∏—Ç–µ –≤ –º–µ—Ç–æ–¥–µ `BuildHtmlShell()`
2. **–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å JavaScript:** –ò—â–∏—Ç–µ –≤ —Å–µ–∫—Ü–∏–∏ `<script>` –≤–Ω—É—Ç—Ä–∏ HTML
3. **–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å C# –º–µ—Ç–æ–¥—ã:** –ò—â–∏—Ç–µ –≤ –∫–ª–∞—Å—Å–µ `TaskPaneControl`
4. **–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:** –ò—â–∏—Ç–µ –≤ `Settings.settings` –∏ `ThisAddIn.cs`
5. **–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å CSS:** –ò—â–∏—Ç–µ –≤ —Å–µ–∫—Ü–∏–∏ `<style>` –≤–Ω—É—Ç—Ä–∏ HTML

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–∏—Ö —ç—Ç–∞–ø–æ–≤

–ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å–ª–µ–¥—É—é—â–∏—Ö —ç—Ç–∞–ø–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç –∂–µ –ø–æ–¥—Ö–æ–¥:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
2. –ù–∞–π–¥–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —ç—Ç–∞–ø–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç –≤ –∫–æ–¥–µ
4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
5. –û—Ç–º–µ—Ç—å—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-27  
**–í–µ—Ä—Å–∏—è:** 1.0

