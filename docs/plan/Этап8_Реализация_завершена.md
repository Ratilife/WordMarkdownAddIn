# –≠—Ç–∞–ø 8: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - –ó–ê–í–ï–†–®–ï–ù–û ‚úÖ

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### ‚úÖ –®–∞–≥ 8.1: –ù–∞–π–¥–µ–Ω—ã –≤—Å–µ –º–µ—Ç–æ–¥—ã
- ‚úÖ `FormatLink` (—Å—Ç—Ä–æ–∫–∞ 798)
- ‚úÖ `FormatListItem` (—Å—Ç—Ä–æ–∫–∞ 882)
- ‚úÖ `FormatQuote` (—Å—Ç—Ä–æ–∫–∞ 933)
- ‚úÖ `FormatTable` (—Å—Ç—Ä–æ–∫–∞ 973)
- ‚úÖ `FormatHorizontalRule` (—Å—Ç—Ä–æ–∫–∞ 1006)

### ‚úÖ –®–∞–≥ 8.2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ FormatLink

**–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–∞ `[` –∏–∑ –Ω–∞—á–∞–ª–∞ —Å—Å—ã–ª–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ `](url)` –∏–∑ –∫–æ–Ω—Ü–∞ —Å—Å—ã–ª–∫–∏
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –Ω–µ—Ç URL —á–∞—Å—Ç–∏

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
```csharp
// –£–¥–∞–ª—è–µ–º [ –∏–∑ –Ω–∞—á–∞–ª–∞
if (currentText.StartsWith("["))
{
    Range startRange = _activeDoc.Range(linkRange.Start, linkRange.Start + 1);
    startRange.Delete();
    linkRange = _activeDoc.Range(linkRange.Start, linkRange.End - 1);
}

// –£–¥–∞–ª—è–µ–º ](url) —á–∞—Å—Ç—å
int closingBracketPos = updatedText.IndexOf(']');
// ... –ª–æ–≥–∏–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è ...
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Å—ã–ª–∫–∞ `[—Ç–µ–∫—Å—Ç](url)` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ `—Ç–µ–∫—Å—Ç` —Å –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–æ–π, –±–µ–∑ –º–∞—Ä–∫–µ—Ä–æ–≤ `[` –∏ `](url)`.

---

### ‚úÖ –®–∞–≥ 8.3: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ FormatListItem

**–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ —Å–ø–∏—Å–∫–∞ –∏–∑ –Ω–∞—á–∞–ª–∞:
  - `- ` (–º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫)
  - `* ` (–º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫)
  - `+ ` (–º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫)
  - `1. `, `2. ` –∏ —Ç.–¥. (–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
```csharp
// –£–¥–∞–ª—è–µ–º –º–∞—Ä–∫–µ—Ä –∏–∑ –Ω–∞—á–∞–ª–∞ —Å—Ç—Ä–æ–∫–∏
if (currentText.StartsWith("- ") || currentText.StartsWith("* ") || currentText.StartsWith("+ "))
{
    Range markerRange = _activeDoc.Range(listRange.Start, listRange.Start + 2);
    markerRange.Delete();
    listRange = _activeDoc.Range(listRange.Start, listRange.End - 2);
}
else
{
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ (1., 2., –∏ —Ç.–¥.)
    var match = Regex.Match(currentText, @"^\d+\.\s");
    if (match.Success)
    {
        int markerLength = match.Length;
        Range markerRange = _activeDoc.Range(listRange.Start, listRange.Start + markerLength);
        markerRange.Delete();
        listRange = _activeDoc.Range(listRange.Start, listRange.End - markerLength);
    }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –≠–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ `- –¢–µ–∫—Å—Ç` –∏–ª–∏ `1. –¢–µ–∫—Å—Ç` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ `–¢–µ–∫—Å—Ç` —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å–ø–∏—Å–∫–∞ Word, –±–µ–∑ –º–∞—Ä–∫–µ—Ä–∞.

---

### ‚úÖ –®–∞–≥ 8.4: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ FormatQuote

**–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–∞ `>` –∏ –ø—Ä–æ–±–µ–ª–∞ –ø–æ—Å–ª–µ –Ω–µ–≥–æ –∏–∑ –Ω–∞—á–∞–ª–∞ —Ü–∏—Ç–∞—Ç—ã
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–≤—É—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤: `> ` (—Å –ø—Ä–æ–±–µ–ª–æ–º) –∏ `>` (–±–µ–∑ –ø—Ä–æ–±–µ–ª–∞)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
```csharp
if (currentText.StartsWith("> "))
{
    // –£–¥–∞–ª—è–µ–º "> " (2 —Å–∏–º–≤–æ–ª–∞)
    Range markerRange = _activeDoc.Range(quoteRange.Start, quoteRange.Start + 2);
    markerRange.Delete();
    quoteRange = _activeDoc.Range(quoteRange.Start, quoteRange.End - 2);
}
else if (currentText.StartsWith(">"))
{
    // –£–¥–∞–ª—è–µ–º —Ç–æ–ª—å–∫–æ ">" (1 —Å–∏–º–≤–æ–ª)
    Range markerRange = _activeDoc.Range(quoteRange.Start, quoteRange.Start + 1);
    markerRange.Delete();
    quoteRange = _activeDoc.Range(quoteRange.Start, quoteRange.End - 1);
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¶–∏—Ç–∞—Ç–∞ `> –¢–µ–∫—Å—Ç` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ `–¢–µ–∫—Å—Ç` —Å–æ —Å—Ç–∏–ª–µ–º —Ü–∏—Ç–∞—Ç—ã Word, –±–µ–∑ –º–∞—Ä–∫–µ—Ä–∞ `>`.

---

### ‚úÖ –®–∞–≥ 8.5: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ FormatTable

**–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –º–∞—Ä–∫–µ—Ä–æ–≤ `|` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
- –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
```csharp
// –£–¥–∞–ª—è–µ–º –º–∞—Ä–∫–µ—Ä—ã | –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
string currentText = tableRange.Text;
if (!string.IsNullOrEmpty(currentText))
{
    // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å–∏–º–≤–æ–ª—ã | –∏–∑ —Ç–µ–∫—Å—Ç–∞ —Ç–∞–±–ª–∏—Ü—ã
    string newText = currentText.Replace("|", "");
    tableRange.Text = newText;
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–∞–±–ª–∏—Ü–∞ —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ `|` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç –±–µ–∑ –º–∞—Ä–∫–µ—Ä–æ–≤ `|`.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è. –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É Word —á–µ—Ä–µ–∑ `Tables.Add()`.

---

### ‚úÖ –®–∞–≥ 8.6: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ FormatHorizontalRule

**–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤ `---`, `***` –∏–ª–∏ `___`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
```csharp
string trimmedText = currentText.Trim();
if (trimmedText.StartsWith("---") || trimmedText.StartsWith("***") || trimmedText.StartsWith("___"))
{
    // –û—á–∏—â–∞–µ–º —Ç–µ–∫—Å—Ç –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ (–æ—Å—Ç–∞–≤–ª—è–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É)
    paragraph.Range.Text = "";
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è `---` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É —Å –≥—Ä–∞–Ω–∏—Ü–µ–π —Å–Ω–∏–∑—É –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞.

---

## üìä –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í–æ –≤—Å–µ –º–µ—Ç–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
- `[FormatLink] –ü—Ä–∏–º–µ–Ω–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏, —É–¥–∞–ª–µ–Ω—ã –º–∞—Ä–∫–µ—Ä—ã [ –∏ ](url)`
- `[FormatListItem] –ü—Ä–∏–º–µ–Ω–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞, —É–¥–∞–ª–µ–Ω –º–∞—Ä–∫–µ—Ä`
- `[FormatQuote] –ü—Ä–∏–º–µ–Ω–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–∏—Ç–∞—Ç—ã, —É–¥–∞–ª–µ–Ω –º–∞—Ä–∫–µ—Ä >`
- `[FormatTable] –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è - —É–¥–∞–ª–µ–Ω—ã –º–∞—Ä–∫–µ—Ä—ã |, —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∞ –≤ Word —Ç–∞–±–ª–∏—Ü—É`
- `[FormatHorizontalRule] –ü—Ä–∏–º–µ–Ω–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏, —É–¥–∞–ª–µ–Ω—ã –º–∞—Ä–∫–µ—Ä—ã ---/***/___`

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

- ‚úÖ –ö–æ–¥ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞
- ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å–∫–ª—é—á–µ–Ω–∏–π

---

## üß™ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### –¢–µ—Å—Ç 1: FormatLink
```
–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç: [–¢–µ–∫—Å—Ç —Å—Å—ã–ª–∫–∏](https://example.com)
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –¢–µ–∫—Å—Ç —Å—Å—ã–ª–∫–∏ (—Å –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–æ–π, –±–µ–∑ [ –∏ ](url))
```

### –¢–µ—Å—Ç 2: FormatListItem
```
–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç: - –≠–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –≠–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ (—Å –º–∞—Ä–∫–µ—Ä–æ–º —Å–ø–∏—Å–∫–∞ Word, –±–µ–∑ -)

–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç: 1. –ü–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ü–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç (—Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π Word, –±–µ–∑ 1.)
```

### –¢–µ—Å—Ç 3: FormatQuote
```
–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç: > –≠—Ç–æ —Ü–∏—Ç–∞—Ç–∞
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –≠—Ç–æ —Ü–∏—Ç–∞—Ç–∞ (—Å–æ —Å—Ç–∏–ª–µ–º —Ü–∏—Ç–∞—Ç—ã Word, –±–µ–∑ >)
```

### –¢–µ—Å—Ç 4: FormatTable
```
–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç: | –°—Ç–æ–ª–±–µ—Ü 1 | –°—Ç–æ–ª–±–µ—Ü 2 |
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –°—Ç–æ–ª–±–µ—Ü 1  –°—Ç–æ–ª–±–µ—Ü 2  (–±–µ–∑ |)
```

### –¢–µ—Å—Ç 5: FormatHorizontalRule
```
–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç: ---
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–µ–π (–≥—Ä–∞–Ω–∏—Ü–µ–π —Å–Ω–∏–∑—É)
```

---

## üìù –°—Ç–∞—Ç—É—Å

**–≠—Ç–∞–ø 8: –ó–ê–í–ï–†–®–ï–ù ‚úÖ**

–í—Å–µ –º–µ—Ç–æ–¥—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ú–∞—Ä–∫–µ—Ä—ã —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ Markdown —Ç–µ–ø–µ—Ä—å —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2024  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

