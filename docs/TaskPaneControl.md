# –ú–æ–¥—É–ª—å TaskPaneControl

## –û–ø–∏—Å–∞–Ω–∏–µ
–û—Å–Ω–æ–≤–Ω–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π WebView2-—Ä–µ–¥–∞–∫—Ç–æ—Ä Markdown —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—é—é —Å–≤—è–∑—å –º–µ–∂–¥—É JavaScript —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º –∏ C# –∫–æ–¥–æ–º, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é Markdown —Å Word –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –∏ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### ‚úÖ –†–µ–¥–∞–∫—Ç–æ—Ä –Ω–∞ –±–∞–∑–µ WebView2
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π HTML/JavaScript —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–º —ç–∫—Ä–∞–Ω–æ–º (—Ä–µ–¥–∞–∫—Ç–æ—Ä + –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Markdig
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫:
  - DOMPurify –¥–ª—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ HTML
  - Prism.js –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –∫–æ–¥–∞
  - Mermaid –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º
  - MathJax –¥–ª—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ä–º—É–ª

### ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å C#
- –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ WebMessageReceived
- –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ/–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ Base64 –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ Markdown –≤ –ø–∞–º—è—Ç–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

### ‚úÖ –ú–µ—Ç–æ–¥—ã –≤—Å—Ç–∞–≤–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **Inline —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: `InsertInline()` - –æ–±–µ—Ä—Ç–∫–∞ –≤–æ–∫—Ä—É–≥ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- **–°–Ω–∏–ø–ø–µ—Ç—ã**: `InsertSnippet()` - –≤—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ Markdown –∫–æ–¥–∞
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏**: `InsertHeading()` - –≤—Å—Ç–∞–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ H1-H6
- **–°–ø–∏—Å–∫–∏**: 
  - `InsertBulletList()` - –º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
  - `InsertNumberedList()` - –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
  - `InsertCheckbox()` - —á–µ–∫–±–æ–∫—Å
- **–¢–∞–±–ª–∏—Ü—ã**: `InsertTable()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏
- **–°—Å—ã–ª–∫–∏**: `InsertLink()` - –≤—Å—Ç–∞–≤–∫–∞ –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–∏
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: `InsertImage()` - –≤—Å—Ç–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- **–ö–æ–¥**: `InsertCodeBlock()` - –±–ª–æ–∫ –∫–æ–¥–∞ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
- **Mermaid**: `InsertMermaidSample()` –∏ `InsertMermaid()` - –¥–∏–∞–≥—Ä–∞–º–º—ã
- **–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞**: `InsertMathSample()` –∏ `InsertMath()` - —Ñ–æ—Ä–º—É–ª—ã LaTeX

### ‚úÖ –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
- **–û—Ç–∫—Ä—ã—Ç–∏–µ**: `OpenMarkdownFile()` - –∑–∞–≥—Ä—É–∑–∫–∞ .md —Ñ–∞–π–ª–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: `SaveMarkdownFile()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤ —Ñ–∞–π–ª
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Word –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏

### ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º—ã–º
- `SetMarkdown()` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
- `GetMarkdownAsync()` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
- `GetCachedMarkdown()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –∫—ç—à–∞

## –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–ø–∏—Å–∞—Ç—å

### üî® –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫**: –ó–∞–º–µ–Ω–∏—Ç—å –ø—É—Å—Ç—ã–µ catch-–±–ª–æ–∫–∏ –Ω–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è**: –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ WebView2**: –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –æ—à–∏–±–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ WebView2

### üî® –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **Debounce –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞**: –£–ª—É—á—à–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º debounce –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫**: –ó–∞–≥—Ä—É–∂–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- **–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞**: –î–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

### üî® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
- **–û—Ç–º–µ–Ω–∞/–ø–æ–≤—Ç–æ—Ä (Undo/Redo)**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–ü–æ–∏—Å–∫ –∏ –∑–∞–º–µ–Ω–∞**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ Markdown
- **–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º**: –ë—ã—Å—Ç—Ä–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤, —Å–∏–º–≤–æ–ª–æ–≤, —Å—Ç—Ä–æ–∫

### üî® –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
- **–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
- **–¶–≤–µ—Ç–æ–≤–∞—è —Ç–µ–º–∞**: –°–≤–µ—Ç–ª–∞—è/—Ç–µ–º–Ω–∞—è —Ç–µ–º–∞
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–æ—Ä/–ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
- **–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

### üî® –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
- **–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤ PDF
- **–ü–µ—á–∞—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –ø–µ—á–∞—Ç–∏
- **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ HTML**: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ HTML –∫–æ–¥–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
- **–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º**: –†–µ–∂–∏–º —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞

### üî® –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **Drag & Drop —Ñ–∞–π–ª–æ–≤**: –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ .md —Ñ–∞–π–ª–æ–≤ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
- **–í—Å—Ç–∞–≤–∫–∞ –∏–∑ –±—É—Ñ–µ—Ä–∞**: –£–º–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ –∏–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞
- **–≠–∫—Å–ø–æ—Ä—Ç –≤ Word**: –ü—Ä—è–º–æ–π —ç–∫—Å–ø–æ—Ä—Ç –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ Word –¥–æ–∫—É–º–µ–Ω—Ç

### üî® –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞
- **–í–∞–ª–∏–¥–∞—Ü–∏—è Markdown**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
- **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è**: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö
- **–ü–æ–¥—Å–∫–∞–∑–∫–∏**: –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ Markdown

## –û—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å

### ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- –í –º–µ—Ç–æ–¥–µ `SetMarkdown()` (—Å—Ç—Ä–æ–∫–∏ 132-133) –µ—Å—Ç—å –¥–≤–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ `!_coreReady`:
```csharp
if (!_coreReady || _webView?.CoreWebView2 == null) return;
if (!_coreReady) return;  // –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ!
```
- –£–¥–∞–ª–∏—Ç—å –≤—Ç–æ—Ä—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ —Å—Ç—Ä–æ–∫–µ 133

### ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ
- –í –º–µ—Ç–æ–¥–µ `OnLoadAsync()` (—Å—Ç—Ä–æ–∫–∏ 41-42) —Å–æ–±—ã—Ç–∏–µ `WebMessageReceived` –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã:
```csharp
_webView.CoreWebView2.WebMessageReceived += CoreWebView2_WebMessageReceived;
_webView.CoreWebView2.WebMessageReceived += CoreWebView2_WebMessageReceived;  // –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ!
```
- –£–¥–∞–ª–∏—Ç—å –æ–¥–Ω—É –∏–∑ —Å—Ç—Ä–æ–∫

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º Base64 –≤ JavaScript
- –í `BuildHtmlShell()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `btoa(encodeURIComponent(text))`, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º
- –í C# –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ UTF-8 ‚Üí Base64
- –í–æ–∑–º–æ–∂–Ω–æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–¥–∏—Ä–æ–≤–æ–∫ –º–µ–∂–¥—É JS –∏ C#
- –ù—É–∂–Ω–æ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥—Ö–æ–¥ –∫ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—é

### ‚ùå –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –±–æ–ª—å—à–∏–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
- –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –ø–µ—Ä–µ–¥–∞—á–∞ —á–µ—Ä–µ–∑ Base64 –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ–π
- –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–º–µ—Ä –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

### ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ª—É—á–∞—è, –∫–æ–≥–¥–∞ WebView2 –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- –ï—Å–ª–∏ WebView2 Runtime –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –Ω–µ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤ –Ω–µ—Ä–∞–±–æ—á–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
- –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å—é
- –ú–µ—Ç–æ–¥ `SaveMarkdownFile()` –æ–±—ä—è–≤–ª–µ–Ω –∫–∞–∫ `async void`, —á—Ç–æ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
- –î–æ–ª–∂–µ–Ω –±—ã—Ç—å `async Task` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É async/await

### ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—á–∏—Å—Ç–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
- –ù–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Dispose –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è WebView2
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∏ –º–æ–≥—É—Ç –æ—Å—Ç–∞—Ç—å—Å—è –∞–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### ‚ùå –°—Ç–∞—Ä—ã–π –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥
- –ú–µ—Ç–æ–¥ `BuildHtmlShell_Old()` (—Å—Ç—Ä–æ–∫–∏ 567-754) –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- –ù—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∫–æ–¥–∞

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –í HTML —à–∞–±–ª–æ–Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –≤—Å—Ç–∞–≤–∫–∏ JavaScript –∫–æ–¥–∞

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

1. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ BuildHtmlShell**:
   - –í—ã–Ω–µ—Å—Ç–∏ HTML —à–∞–±–ª–æ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª —Ä–µ—Å—É—Ä—Å–æ–≤
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ HTML

2. **–£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫**:
   - –°–æ–∑–¥–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

3. **–î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã**:
   - –¢–µ—Å—Ç—ã –¥–ª—è –º–µ—Ç–æ–¥–æ–≤ –≤—Å—Ç–∞–≤–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
   - –¢–µ—Å—Ç—ã –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è/–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

4. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö**:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–µ—Ä–µ–¥–∞—á–∏
   - –î–æ–±–∞–≤–∏—Ç—å —Å–∂–∞—Ç–∏–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

5. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å IDisposable**:
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ WebView2
   - –û—á–∏—Å—Ç–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ —Å–æ–±—ã—Ç–∏—è

6. **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**:
   - –ó–∞–º–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π

7. **–£–ª—É—á—à–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç**:
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏




































